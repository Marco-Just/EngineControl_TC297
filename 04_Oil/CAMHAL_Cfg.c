/******************************************************************************/
/* !Layer           : HAL                                                     */
/* !Component       : CAMHAL                                                  */
/* !Description     : Camshaft management                                     */
/*                                                                            */
/* !File            : CAMHAL_Cfg.c                                            */
/* !Description     : CAMHAL configuration                                    */
/*                                                                            */
/* !Reference       :                                                         */
/*                                                                            */
/* Coding language  : C                                                       */
/*                                                                            */
/* COPYRIGHT VALEO all rights reserved                                        */
/******************************************************************************/
/* Dimension Informations
 * %PCMS_HEADER_SUBSTITUTION_START:%
 * The PID has this format: <Product ID>:<Item ID>.<Variant>-<Item Type>;<Revision>
 * %PID: P2017_BSW:A81081.A-SRC;3 %
 * %PCMS_HEADER_SUBSTITUTION_END:%
 ******************************************************************************/
/** 11/10/14, 10:16:14: generated by Genecode v2.6.0.0                        */
/******************************************************************************/

#include "Std_Types.h"
#include "CAMHAL.h"
#include "CAMHAL_L.h"
#include "CRKHAL.h"
#include "CAMHAL_Cfg.h"
#include "CAMHAL_Typ.h"
#include "DGOHAL.h"
#include "CAMHAL_I.h"
#include "Dio.h"
#include "Dio_Cfg.h"
#include "TSKSRV.h"
#include "CAMHAL_gtm_cfg.h"
#include "KRN.h"

/******************************************************************************/
/* DATA DECLARATIONS                                                          */
/******************************************************************************/
#define CAMHAL_START_SEC_CONST_8BIT
#include "CAMHAL_MemMap.h"

const uint8 CAMHAL_kau8CrkAlarm[2] =
{
   CRKHAL_u8ALARM_CAMHAL_INCAM_EDGE_MNG,
   CRKHAL_u8ALARM_CAMHAL_EXCAM_EDGE_MNG
};

#define CAMHAL_STOP_SEC_CONST_8BIT
#include "CAMHAL_MemMap.h"


#define CAMHAL_START_SEC_VAR_CLEARED_UNSPECIFIED
#include "CAMHAL_MemMap.h"

volatile Ifx_GTM_TIM_CH*  CAMHAL_IntakeTim;
volatile Ifx_GTM_TIM_CH*  CAMHAL_ExhaustTim;

#define CAMHAL_STOP_SEC_VAR_CLEARED_UNSPECIFIED
#include "CAMHAL_MemMap.h"

/******************************************************************************/
/* PRIVATE FUNCTION DEFINITIONS                                               */
/******************************************************************************/

#define CAMHAL_START_SEC_CODE
#include "CAMHAL_MemMap.h"

/******************************************************************************/
/*                                                                            */
/* !FuncName     : CAMHAL_bDioRead / A                                        */
/*                                                                            */
/* !Description  : Function called to read the DIO input level                */
/* !LastAuthor   : Valeo                                                      */
/******************************************************************************/
boolean CAMHAL_bDioRead(CAMHAL_tudtChannel udtChannelName)
{
   boolean bLocal;

   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         bLocal = (boolean)Dio_ReadChannel(DioConf_DioChannel_M_INTK_CAM_POS);
         break;

      case CAMHAL_udtCH_CM_72:
         bLocal = (boolean)Dio_ReadChannel(DioConf_DioChannel_M_EXH_CAM_POS);
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         bLocal = (boolean)FALSE;
         break;
   }
   return(bLocal);
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidActivateCamEvent / A                              */
/*                                                                            */
/* !Description : Function called to activate the CAM_PERIOD event task       */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidActivateCamEvent(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         TSKSRV_vidActivateTask(CAMHAL_INCAM_PERIOD_EVENT);
         break;

      case CAMHAL_udtCH_CM_72:
         TSKSRV_vidActivateTask(CAMHAL_EXCAM_PERIOD_EVENT);
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidActivateCamEdgeEvent / A                          */
/*                                                                            */
/* !Description : Function called to activate the CAM_EDGE event task         */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidActivateCamEdgeEvent(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         TSKSRV_vidActivateTask(CAMHAL_INCAM_EDGE_EVENT);
         break;

      case CAMHAL_udtCH_CM_72:
         TSKSRV_vidActivateTask(CAMHAL_EXCAM_EDGE_EVENT);
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidDgoWriteFault / A                                 */
/*                                                                            */
/* !Description : Function called to write default in DGO                     */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidDgoWriteFault(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         DGOHAL_vidWrite( DGOHAL_udtCAMHAL,
                          DGOHAL_bfVALID_CAM_PATTERN,
                          DGOHAL_bfFAULT_CAM_PATTERN);
         break;

      case CAMHAL_udtCH_CM_72:
         DGOHAL_vidWrite( DGOHAL_udtCAMEXHAL,
                          DGOHAL_bfVALID_CAM_PATTERN,
                          DGOHAL_bfFAULT_CAM_PATTERN);
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidDgoWriteNoFault / A                               */
/*                                                                            */
/* !Description : Function called to write no default in DGO                  */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidDgoWriteNoFault(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         DGOHAL_vidWrite( DGOHAL_udtCAMHAL,
                          DGOHAL_bfVALID_CAM_PATTERN,
                          DGOHAL_bfNO_FAULT_CAM_PATTERN);
         break;

      case CAMHAL_udtCH_CM_72:
         DGOHAL_vidWrite( DGOHAL_udtCAMEXHAL,
                          DGOHAL_bfVALID_CAM_PATTERN,
                          DGOHAL_bfNO_FAULT_CAM_PATTERN);
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidNormalModeEntry / A                               */
/*                                                                            */
/* !Description : Function called when entering in normal mode                */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidNormalModeEntry(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         KRN_vidINCAM_NORMAL_MODE_BSW_PRE();
         break;

      case CAMHAL_udtCH_CM_72:
         KRN_vidEXCAM_NORMAL_MODE_BSW_PRE();
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidDwnModeEntry / A                                  */
/*                                                                            */
/* !Description : Function called when entering in downgraded mode            */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidDwnModeEntry(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         KRN_vidINCAM_DOWN_MODE_BSW_PRE();
         break;

      case CAMHAL_udtCH_CM_72:
         KRN_vidEXCAM_DOWN_MODE_BSW_PRE();
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidSyncLossEntry / A                                 */
/*                                                                            */
/* !Description : Function called when loosing synchronisation                */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidSyncLossEntry(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         KRN_vidS_TOLO_INTERRUPT_BSW();
         break;

      case CAMHAL_udtCH_CM_72:
         KRN_vidS_TOLO_INTERRUPT_BSW();
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidSyncFoundEntry / A                                */
/*                                                                            */
/* !Description : Function called when finding synchronisation                */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidSyncFoundEntry(CAMHAL_tudtChannel udtChannelName)
{
   switch(udtChannelName)
   {
      case CAMHAL_udtCH_CM_81:
         break;

      case CAMHAL_udtCH_CM_72:
         break;

      default:
         SWFAIL_vidSoftwareErrorHook();
         break;
   }
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidSyncFoundEntry / A                                */
/*                                                                            */
/* !Description : Function called by the CM_81 interrupt                     */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidInCamCaptureManagement(uint8 ModuleType, uint8 ModuleNo, uint8 ChannelNo, uint16 IrqNotifVal)
{
   COMPILER_UNUSED_PARAMETER(ModuleType);
   COMPILER_UNUSED_PARAMETER(ModuleNo);
   COMPILER_UNUSED_PARAMETER(ChannelNo);
   COMPILER_UNUSED_PARAMETER(IrqNotifVal);

   CAMHAL_vidCaptureManagement(CAMHAL_udtCH_CM_81);
}

/******************************************************************************/
/*                                                                            */
/* !FuncName    : CAMHAL_vidSyncFoundEntry / A                                */
/*                                                                            */
/* !Description : Function called by the CM_72 interrupt                     */
/* !LastAuthor  : Valeo                                                       */
/******************************************************************************/
void CAMHAL_vidExCamCaptureManagement(uint8 ModuleType, uint8 ModuleNo, uint8 ChannelNo, uint16 IrqNotifVal)
{
   COMPILER_UNUSED_PARAMETER(ModuleType);
   COMPILER_UNUSED_PARAMETER(ModuleNo);
   COMPILER_UNUSED_PARAMETER(ChannelNo);
   COMPILER_UNUSED_PARAMETER(IrqNotifVal);

   CAMHAL_vidCaptureManagement(CAMHAL_udtCH_CM_72);
}


#define CAMHAL_STOP_SEC_CODE
#include "CAMHAL_MemMap.h"


/*------------------------------ end of file ---------------------------------*/
